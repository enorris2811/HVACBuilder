<!DOCTYPE html>
<html>

<head>
    <title>HVAC Builder</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <link rel="stylesheet" type='text/css' href="/stylesheets/style.css">
</head>

<body>

    <nav id='navTop' class="navbar navbar-expand-sm justify-content-end">
        <ul class="navbar-nav justify-content-right">
            <img src="/public/images/CCG_Logo_New.bmp" class="rounded-circle" alt="CCG LOGO">
            <li class="nav-item"></li>
            <a class="nav-link" id='home' href="/">Get Started</a>
            </li>
            <li class="nav-item">
                </liclass>
                <a class='nav-link' id='options' href="/options">Projects</a>
            </li>
            <li class="nav-item"></li>

            <a class="nav-link" id='points' href='/points'>Contact</a>
            </li>
            <li class="nav-item"></li>
            <a class="nav-link" id='sequence' href='/sequence'>Login</a></li>
            </li>
        </ul>
    </nav>
    <div class='row'>
        <div id='sideBar' class='container col-sm-3'>

            <ul class="nav flex-column">
                <li>Projects</li>
            </ul>


        </div>

        <div id='navBottom' class='container col-sm-9'>
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href='/'>Overview</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href='/options'> Options</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href='/points'>Points</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href='/sequence'>Sequence</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href='/drawings'>Drawings</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href='/material'>Material</a>
                </li>


            </ul>
        </div>


    </div>
    <div class="container col-sm-9">
        <h1>HVAC Builder</h1>
        <div id='selectAHUDiv'>
            <form id='selectAHUForm' action='/' method='GET'>
                <label>Select an AHU unit in the Project</label>
                <select id='selectAHU'>
                    <option>select...</option>
                </select>
                <button id='ahuButton' type='button'>Select Unit Options</button>
            </form>
        </div>
    </div>


</body>
<script>

    $(document).ready(function () {
        var project = JSON.parse(localStorage.getItem('project'));
        if (project != undefined) {
            var x;
            var flag;
            var url = document.URL;
            var n = url.lastIndexOf('/');
            var ahuName = url.substring((n + 1), url.length);
            console.log(ahuName);
            var i = 0;
            for (x in project.units) {
                if (project.units[x] != null) {
                    var option = document.createElement('option');
                    var parentNode = document.getElementById('selectAHU');
                    parentNode.appendChild(option);
                    option.textContent = project.units[x].name;
                    console.log(x);
                    if (ahuName == project.units[x].name) {
                        console.log('inside');
                        flag = i;
                    }
                }
                i++;
            }
            flag = flag + 1;
            console.log((flag));
            parentNode.selectedIndex = (flag);
            parentNode.submit;
            getOptions();
        }
    })

    document.getElementById('selectAHU').onchange = function () {
        var s = document.getElementById('selectAHU').selectedIndex - 1;
        var project = JSON.parse(localStorage.getItem('project'));
        console.log(project.units);
        var modelType = project.units[s].type;
        var ahuName = project.units[s].name;
        console.log(modelType);
        var f = document.getElementById('selectAHUForm');
        switch (modelType) {
            case 'cv':

                $.get('/options/cv', function (data, status) {

                });
                break;
            case 'vav':
                $.get('/options/vav', function (data, status) {
                    console.log('called vav');
                });
                break;

        }
    }

    document.getElementById('ahuButton').onclick = getOptions();

    function getOptions() {
        var s = document.getElementById('selectAHU').selectedIndex - 1;
        var project = JSON.parse(localStorage.getItem('project'));
        console.log(project.units);
        var modelType = project.units[s].type;
        console.log(modelType);
        var f = document.getElementById('selectAHUForm');
        switch (modelType) {
            case 'cv':
                f.action = '/options/cv';
                f.submit();
                break;
            case 'vav':
                $.get('/options/vav', function (data, status) {
                    console.log('called vav');
                });
                break;

        }
    }
</script>

</html>